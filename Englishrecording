index.htmlimport React, { useState } from 'react';

// Main App component
const App = () => {
    // Removed studentName state as it's no longer needed for input
    const [activity, setActivity] = useState('');
    const [generatedSetec, setGeneratedSetec] = useState('');
    const [isLoading, setIsLoading] = useState(false);
    const [error, setError] = useState('');

    // Function to call the Gemini API for text generation
    const generateSetec = async () => {
        setIsLoading(true);
        setError('');
        setGeneratedSetec(''); // Clear previous output

        // Validate if activity content is provided
        if (!activity) {
            setError('활동 내용을 입력해주세요.');
            setIsLoading(false);
            return;
        }

        const prompt = `
        다음 활동 내용을 바탕으로 고등학교 '영어과' 교과 세특(세부능력 및 특기사항) 기준에 맞춰 한 단락으로 작성해주세요.
        세특에는 학생 이름을 직접 언급하지 말고, '~임' 또는 '~함'과 같은 문어체 종결형을 사용해주세요.
        활동 내용: ${activity}

        2022 개정 교육과정의 영어 과목 핵심 역량인 '영어 의사소통 역량', '자기관리 역량', '공동체 역량', '지식정보처리 역량'이 활동 내용에 자연스럽게 녹아들어 표현되도록 작성해주세요. 각 역량의 이름을 직접적으로 언급하지 않으면서도, 해당 역량이 발휘된 구체적인 상황과 학생의 노력을 서술해주십시오.

        학생의 역량 활용 수준이 다소 부족한 부분이 있더라도, 긍정적이고 성장 지향적인 언어로 피드백하여 학생의 노력과 발전 가능성을 강조해주세요. 예를 들어, '발표 내용의 정확성', '시각 자료 활용 능력', '적절한 어휘 선택', '어법의 정확성', '수업시간 학습한 어법의 활용 능력', '청중과의 소통', '발음의 유창성' 등 각 평가 요소에서 학생이 보여준 긍정적인 태도, 노력, 그리고 앞으로의 발전 가능성에 초점을 맞춰주십시오.

        작성 시 다음 '학교생활기록부 기재요령'을 반드시 준수해주세요:
        1.  과목별 성취기준에 따른 성취수준의 특성 및 학습활동 참여도, 자기주도적 학습에 의한 변화와 성장 정도를 중심으로 구체적으로 기재함.
        2.  수업에서 이루어진 활동의 단순 나열이나 이미 성취기준에 명시된 지식의 단순 서술은 지양함.
        3.  다음과 같은 내용은 절대 포함하지 않음:
            -   각종 공인어학시험 참여 사실과 그 성적 및 수상 실적
            -   교과·비교과 관련 교내·외 대회 참여 사실과 그 성적 및 수상 실적 (학교장의 참가 허락을 받아 참여한 교외대회 수상실적도 불가)
            -   교외 기관·단체(장) 등에게 수상한 교외상
            -   교내·외 인증시험 참여 사실이나 그 성적
            -   모의고사·전국연합학력평가 성적
            -   논문을 학회지 등에 투고 또는 등재하거나 학회 등에서 발표한 사실
            -   도서출간 사실, 지식재산권(특허, 실용신안, 상표, 디자인 등) 출원 또는 등록 사실
            -   특정 대학명, 기관명(기구, 단체, 조직 등 포함), 상호명, 강사명 등 (단, 교육관련기관 및 학교 밖 교육기관 유형은 예외)
            -   방과후학교 활동
            -   독서 과정의 관찰·확인이 어려운 독서 성향 등 (읽은 책의 제목과 저자만 기재)
            -   자율탐구활동으로 작성한 연구보고서(소논문) 실적 (단, 탐구보고서 등으로 편법적 기재 금지)

        긍정적이고 발전적인 방향으로 작성하며, 학생의 개별적인 특성이 드러나도록 해주세요.
        `;

        let chatHistory = [];
        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
        const payload = { contents: chatHistory };
        const apiKey = ""; // API key is provided by the environment
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`API error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
            }

            const result = await response.json();
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const text = result.candidates[0].content.parts[0].text;
                setGeneratedSetec(text);
            } else {
                setError('세특 생성에 실패했습니다. 응답 형식이 올바르지 않습니다.');
            }
        } catch (err) {
            console.error("Error generating setec:", err);
            setError(`세특 생성 중 오류가 발생했습니다: ${err.message}`);
        } finally {
            setIsLoading(false);
        }
    };

    return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4 font-inter">
            <div className="bg-white p-8 rounded-2xl shadow-xl w-full max-w-3xl border border-gray-200">
                <h1 className="text-4xl font-extrabold text-center text-gray-800 mb-8">
                    교과 세특 생성기
                </h1>

                {/* Removed the student name input field */}

                <div className="mb-6">
                    <label htmlFor="activity" className="block text-lg font-semibold text-gray-700 mb-2">
                        활동 내용 (구체적으로 작성해주세요)
                    </label>
                    <textarea
                        id="activity"
                        rows="8"
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out resize-y text-gray-800"
                        placeholder="예: '영어 원서를 읽고 등장인물의 심리 변화를 분석하는 프로젝트를 수행함. 특히, 인물의 대사와 행동을 통해 심리적 갈등을 심층적으로 탐구하고, 이를 영어 에세이로 논리정연하게 작성하여 발표함.'"
                        value={activity}
                        onChange={(e) => setActivity(e.target.value)}
                    ></textarea>
                </div>

                <button
                    onClick={generateSetec}
                    disabled={isLoading}
                    className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed text-xl"
                >
                    {isLoading ? (
                        <div className="flex items-center justify-center">
                            <svg className="animate-spin h-6 w-6 mr-3 text-white" viewBox="0 0 24 24">
                                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            생성 중...
                        </div>
                    ) : (
                        '세특 생성'
                    )}
                </button>

                {error && (
                    <div className="mt-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg text-center">
                        {error}
                    </div>
                )}

                {generatedSetec && (
                    <div className="mt-8 p-6 bg-gray-50 border border-gray-200 rounded-lg shadow-inner">
                        <h2 className="text-2xl font-bold text-gray-800 mb-4">생성된 세특</h2>
                        <p className="whitespace-pre-wrap text-gray-800 leading-relaxed">
                            {generatedSetec}
                        </p>
                    </div>
                )}
            </div>
        </div>
    );
};

export default App;
